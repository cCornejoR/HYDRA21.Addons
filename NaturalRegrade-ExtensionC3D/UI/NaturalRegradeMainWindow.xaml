<Window x:Class="NaturalRegrade_addon.UI.NaturalRegradeMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Natural Regrade - Análisis Geomorfológico" 
        Height="800" 
        Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Icon="/Resources/logo.ico"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Window.Resources>
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            <Setter Property="Margin" Value="0,15,0,10"/>
        </Style>
        
        <Style x:Key="ParameterLabelStyle" TargetType="Label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,5,0,0"/>
        </Style>
        
        <Style x:Key="SliderStyle" TargetType="Slider" BasedOn="{StaticResource MaterialDesignSlider}">
            <Setter Property="Margin" Value="0,5,0,15"/>
            <Setter Property="Height" Value="20"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
            <materialDesign:PackIcon Kind="Terrain" 
                                     Width="48" 
                                     Height="48" 
                                     VerticalAlignment="Center"
                                     Foreground="{DynamicResource MaterialDesignDarkForeground}"/>
            <StackPanel Margin="15,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="NATURAL REGRADE" 
                          FontSize="24" 
                          FontWeight="Bold"
                          Foreground="{DynamicResource MaterialDesignDarkForeground}"/>
                <TextBlock Text="Análisis Geomorfológico Avanzado para Civil 3D" 
                          FontSize="12" 
                          Foreground="{DynamicResource MaterialDesignBodyLight}"/>
            </StackPanel>
        </StackPanel>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                
                <!-- Surface Selection -->
                <materialDesign:Card Margin="0,0,0,20" Padding="20">
                    <StackPanel>
                        <TextBlock Text="SELECCIÓN DE SUPERFICIE" Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <Label Content="Superficie TIN a Procesar:" Style="{StaticResource ParameterLabelStyle}"/>
                        <ComboBox x:Name="SurfaceComboBox" 
                                 materialDesign:HintAssist.Hint="Seleccione una superficie TIN"
                                 Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                 Margin="0,5,0,10"/>
                                 
                        <TextBlock Text="La superficie seleccionada será analizada hidrológicamente para generar una nueva superficie con características geomorfológicas naturales."
                                  FontStyle="Italic"
                                  TextWrapping="Wrap"
                                  Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Hydrologic Parameters -->
                <materialDesign:Card Margin="0,0,0,20" Padding="20">
                    <StackPanel>
                        <TextBlock Text="PARÁMETROS HIDROLÓGICOS" Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <Label x:Name="GridResolutionLabel" Style="{StaticResource ParameterLabelStyle}"/>
                        <Slider x:Name="GridResolutionSlider" 
                               Minimum="1" 
                               Maximum="20" 
                               Value="5"
                               TickFrequency="1"
                               IsSnapToTickEnabled="True"
                               Style="{StaticResource SliderStyle}"/>
                        
                        <Label x:Name="MinFlowAccumulationLabel" Style="{StaticResource ParameterLabelStyle}"/>
                        <Slider x:Name="MinFlowAccumulationSlider" 
                               Minimum="10" 
                               Maximum="1000" 
                               Value="100"
                               TickFrequency="10"
                               Style="{StaticResource SliderStyle}"/>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Smoothing Parameters -->
                <materialDesign:Card Margin="0,0,0,20" Padding="20">
                    <StackPanel>
                        <TextBlock Text="PARÁMETROS DE SUAVIZADO" Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <Label x:Name="SmoothingFactorLabel" Style="{StaticResource ParameterLabelStyle}"/>
                        <Slider x:Name="SmoothingFactorSlider" 
                               Minimum="0.1" 
                               Maximum="1.0" 
                               Value="0.3"
                               TickFrequency="0.1"
                               Style="{StaticResource SliderStyle}"/>
                        
                        <Label x:Name="IterationsLabel" Style="{StaticResource ParameterLabelStyle}"/>
                        <Slider x:Name="IterationsSlider" 
                               Minimum="1" 
                               Maximum="20" 
                               Value="5"
                               TickFrequency="1"
                               IsSnapToTickEnabled="True"
                               Style="{StaticResource SliderStyle}"/>
                        
                        <Label x:Name="MaxSlopeLabel" Style="{StaticResource ParameterLabelStyle}"/>
                        <Slider x:Name="MaxSlopeSlider" 
                               Minimum="15" 
                               Maximum="45" 
                               Value="30"
                               TickFrequency="5"
                               Style="{StaticResource SliderStyle}"/>

                        <!-- Smoothing Options -->
                        <StackPanel Orientation="Vertical" Margin="0,10,0,0">
                            <CheckBox x:Name="PreserveDrainageCheckBox" 
                                     Content="Preservar líneas de drenaje durante suavizado"
                                     IsChecked="True"
                                     Style="{StaticResource MaterialDesignCheckBox}"
                                     Margin="0,5"/>
                            
                            <CheckBox x:Name="AdaptiveSmoothingCheckBox" 
                                     Content="Usar suavizado adaptativo basado en rugosidad local"
                                     IsChecked="True"
                                     Style="{StaticResource MaterialDesignCheckBox}"
                                     Margin="0,5"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Output Configuration -->
                <materialDesign:Card Margin="0,0,0,20" Padding="20">
                    <StackPanel>
                        <TextBlock Text="CONFIGURACIÓN DE SALIDA" Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <Label Content="Nombre de Superficie Resultado:" Style="{StaticResource ParameterLabelStyle}"/>
                        <TextBox x:Name="OutputSurfaceNameTextBox" 
                                Text="NaturalRegrade_Surface"
                                materialDesign:HintAssist.Hint="Nombre para la nueva superficie TIN"
                                Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                Margin="0,5,0,15"/>
                        
                        <Label Content="Nombre de Capa de Drenaje:" Style="{StaticResource ParameterLabelStyle}"/>
                        <TextBox x:Name="DrainageLayerNameTextBox" 
                                Text="NATURAL_DRAINAGE"
                                materialDesign:HintAssist.Hint="Nombre para la capa de líneas de drenaje"
                                Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                Margin="0,5,0,15"/>
                        
                        <Label x:Name="ContourIntervalLabel" Style="{StaticResource ParameterLabelStyle}"/>
                        <Slider x:Name="ContourIntervalSlider" 
                               Minimum="0.5" 
                               Maximum="5.0" 
                               Value="1.0"
                               TickFrequency="0.5"
                               Style="{StaticResource SliderStyle}"/>

                        <!-- Output Options -->
                        <StackPanel Orientation="Vertical" Margin="0,10,0,0">
                            <CheckBox x:Name="CreateContoursCheckBox" 
                                     Content="Crear curvas de nivel automáticamente"
                                     IsChecked="True"
                                     Style="{StaticResource MaterialDesignCheckBox}"
                                     Margin="0,5"/>
                            
                            <CheckBox x:Name="ValidateErosionCheckBox" 
                                     Content="Validar resistencia a erosión del resultado"
                                     IsChecked="True"
                                     Style="{StaticResource MaterialDesignCheckBox}"
                                     Margin="0,5"/>
                            
                            <CheckBox x:Name="GenerateReportCheckBox" 
                                     Content="Generar reporte técnico detallado"
                                     IsChecked="True"
                                     Style="{StaticResource MaterialDesignCheckBox}"
                                     Margin="0,5"/>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Information Panel -->
                <materialDesign:Card Background="{DynamicResource MaterialDesignDarkBackground}" 
                                    Foreground="{DynamicResource MaterialDesignDarkForeground}"
                                    Margin="0,0,0,20" 
                                    Padding="20">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <materialDesign:PackIcon Kind="Information" 
                                                    Width="24" 
                                                    Height="24" 
                                                    VerticalAlignment="Center"
                                                    Foreground="{DynamicResource MaterialDesignDarkForeground}"/>
                            <TextBlock Text="INFORMACIÓN TÉCNICA" 
                                      FontWeight="Bold" 
                                      FontSize="14"
                                      Margin="10,0,0,0"
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <TextBlock TextWrapping="Wrap" LineHeight="18">
                            <Run Text="Este plugin implementa algoritmos geomorfológicos avanzados basados en investigación científica de GeoFluv Inc. "/>
                            <Run Text="El procesamiento incluye análisis hidrológico D8, generación de redes de drenaje naturales, "/>
                            <Run Text="suavizado adaptativo y optimización para resistencia a erosión. "/>
                            <LineBreak/>
                            <LineBreak/>
                            <Run Text="Referencias: Bugosh &amp; Eckels (2025), Hancock et al. (2018), Zapico et al. (2018), "/>
                            <Run Text="Zhang et al. (2018), Duque &amp; Bugosh (2016-2012)."/>
                        </TextBlock>
                    </StackPanel>
                </materialDesign:Card>

            </StackPanel>
        </ScrollViewer>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" 
                   Orientation="Horizontal" 
                   HorizontalAlignment="Right" 
                   Margin="0,20,0,0">
            
            <Button x:Name="HelpButton" 
                   Content="AYUDA"
                   Style="{StaticResource MaterialDesignOutlinedButton}"
                   Width="100"
                   Height="35"
                   Margin="0,0,10,0"
                   Click="HelpButton_Click">
                <Button.ToolTip>
                    <ToolTip Content="Mostrar ayuda y documentación"/>
                </Button.ToolTip>
            </Button>
            
            <Button x:Name="PreviewButton" 
                   Content="VISTA PREVIA"
                   Style="{StaticResource MaterialDesignOutlinedButton}"
                   Width="120"
                   Height="35"
                   Margin="0,0,10,0"
                   Click="PreviewButton_Click">
                <Button.ToolTip>
                    <ToolTip Content="Ver resumen de parámetros configurados"/>
                </Button.ToolTip>
            </Button>
            
            <Button x:Name="RestoreDefaultsButton" 
                   Content="RESTAURAR"
                   Style="{StaticResource MaterialDesignOutlinedButton}"
                   Width="100"
                   Height="35"
                   Margin="0,0,10,0"
                   Click="RestoreDefaultsButton_Click">
                <Button.ToolTip>
                    <ToolTip Content="Restaurar todos los parámetros a valores por defecto"/>
                </Button.ToolTip>
            </Button>
            
            <Button x:Name="CancelButton" 
                   Content="CANCELAR"
                   Style="{StaticResource MaterialDesignOutlinedSecondaryButton}"
                   Width="100"
                   Height="35"
                   Margin="0,0,10,0"
                   Click="CancelButton_Click"/>
            
            <Button x:Name="ExecuteButton" 
                   Content="EJECUTAR"
                   Style="{StaticResource MaterialDesignRaisedButton}"
                   Width="120"
                   Height="35"
                   Click="ExecuteButton_Click">
                <Button.ToolTip>
                    <ToolTip Content="Iniciar procesamiento de Natural Regrade"/>
                </Button.ToolTip>
            </Button>
        </StackPanel>
    </Grid>
</Window>
